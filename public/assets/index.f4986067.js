import{d as O,ad as v,a4 as tt,E as e,H as w,S as r,z as n,V as h,R as u,Z as B,aq as x,aU as E,ae as et,a as H,a0 as at,o as st,a2 as ot,G as o,J as y,F as f,X as D,K as m,b9 as ut,$ as nt,a9 as A}from"./main.78b17f62.js";import{m as X,i as rt}from"./useStore.194a0dae.js";import{u as lt}from"./useStore.d23d0a49.js";import{u as it}from"./useStore.5309c7ea.js";import{V as pt}from"./VMenu.54b2c8f2.js";import{V as ct,a as V,b as F}from"./VList.4ad28452.js";import{a as mt}from"./VBtn.320fdb24.js";import{_ as Ct}from"./BaseIndexView.vue_vue_type_style_index_0_lang.1d579ebe.js";import dt from"./SalesSlipDialog.846115d4.js";import{_ as _t}from"./CancelTransDialog.vue_vue_type_script_setup_true_lang.5fd9e440.js";import ft from"./BaseIndexFilterCard.c0dac5e0.js";import{_ as M}from"./BaseQuestionTooltip.vue_vue_type_script_setup_true_lang.df8891af.js";import{a as Bt}from"./useStore.0843e9fa.js";import{V as gt}from"./VCol.0ff826f7.js";import{V as vt}from"./VSelect.93e2d2df.js";import{V as Z}from"./VChip.138758bf.js";import"./searcher.a0ee88b4.js";import"./lodash.f058a0cc.js";import"./_commonjsHelpers.f037b798.js";import"./forwardRefs.54bb1675.js";import"./scopeId.9d34f5e3.js";import"./router.e9f67d83.js";import"./lazy.94029559.js";import"./anchor.72dc3ea9.js";import"./transition.88a89596.js";import"./dialog-transition.a961e4d7.js";import"./variant.0ba62894.js";import"./index.81805f13.js";import"./createSimpleFunctional.969b65aa.js";import"./index.ec1cb6cc.js";import"./loader.3df0b519.js";import"./VAvatar.96fb312d.js";import"./VImg.e4ff0efb.js";import"./index.15e12812.js";import"./VDivider.f97cd26a.js";import"./group.b2e1e8a7.js";import"./position.9716b1f0.js";import"./SearchFilterDialog.vue_vue_type_script_setup_true_lang.65a69b2f.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang.02d2b65c.js";import"./VCard.48597641.js";import"./VCardText.81641b7d.js";import"./VRow.41c6ce79.js";import"./VInput.57f39dd4.js";import"./form.787e97f4.js";import"./VCheckboxBtn.5ee340c9.js";import"./VSelectionControl.9741ea49.js";import"./VDialog.baf900d5.js";import"./BaseIndexChart.vue_vue_type_script_setup_true_lang.5ee5c2fc.js";import"./BaseIndexFilter.a1102766.js";import"./AppDateTimePicker.vue_vue_type_style_index_0_lang.2cd5b997.js";import"./VCounter.f26bb906.js";import"./VTextField.db80de25.js";/* empty css                   */import"./VTable.93f5fa18.js";import"./DialogHalfVCol.5a1417c0.js";import"./validators.f65c6173.js";import"./VForm.c0eea51c.js";import"./AppCardActions.vue_vue_type_style_index_0_lang.b297e84b.js";import"./BaseIndexSalesFilter.vue_vue_type_script_setup_true_lang.16f77906.js";import"./VAutocomplete.5b3cdfa6.js";import"./BaseIndexPGFilter.vue_vue_type_script_setup_true_lang.0dd6ae59.js";import"./VTooltip.22328f9b.js";const ht=O({__name:"ExtraMenu",props:{item:null},setup(N){const a=N,d=v("alert"),b=v("snackbar"),S=v("$errorHandler"),L=v("salesslip"),k=v("cancelTran"),$=tt(),T=()=>{var i;const _={pg_id:a.item.pg_id,mcht_id:a.item.mcht_id,appr_dt:(i=a.item.trx_dt)==null?void 0:i.toString(),appr_num:a.item.appr_num,issuer:a.item.issuer,cust_name:a.item.buyer_name,phone_num:a.item.buyer_phone,tid:a.item.tid};$.push({path:"/complaints/create",query:_})},z=async()=>{if(await d.value.show("\uC815\uB9D0 \uC0C1\uC704 PG\uC0AC\uB97C \uD1B5\uD574 \uACB0\uC81C\uB97C \uCDE8\uC18C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){const _={pmod_id:a.item.pmod_id,amount:a.item.amount,trx_id:a.item.trx_id,only:!1};try{const i=await et.post("/api/v1/manager/transactions/pay-cancel",_);b.value.show("\uC131\uACF5\uD558\uC600\uC2B5\uB2C8\uB2E4.","success")}catch(i){b.value.show(i.response.data.message,"error"),S(i)}}};return(_,i)=>(e(),w(mt,{icon:"",size:"x-small",color:"default",variant:"text"},{default:r(()=>[n(h,{size:"22",icon:"tabler-dots-vertical"}),n(pt,{activator:"parent"},{default:r(()=>[n(ct,null,{default:r(()=>[n(V,{value:"saleslip",onClick:i[0]||(i[0]=c=>u(L).show(a.item))},{prepend:r(()=>[n(h,{size:"24",class:"me-3",icon:"tabler:receipt"})]),default:r(()=>[n(F,null,{default:r(()=>[B("\uB9E4\uCD9C\uC804\uD45C")]),_:1})]),_:1}),n(V,{value:"complaint",onClick:i[1]||(i[1]=c=>T())},{prepend:r(()=>[n(h,{size:"24",class:"me-3",icon:"ic-round-sentiment-dissatisfied"})]),default:r(()=>[n(F,null,{default:r(()=>[B("\uBBFC\uC6D0\uCC98\uB9AC")]),_:1})]),_:1}),x(n(V,{value:"cancelTrans",onClick:i[2]||(i[2]=c=>u(k).show(a.item))},{prepend:r(()=>[n(h,{size:"24",class:"me-3",icon:"tabler:device-tablet-cancel"})]),default:r(()=>[n(F,null,{default:r(()=>[B("\uCDE8\uC18C\uB9E4\uCD9C\uC0DD\uC131")]),_:1})]),_:1},512),[[E,a.item.is_cancel==!1]]),x(n(V,{value:"cancel",onClick:i[3]||(i[3]=c=>z())},{prepend:r(()=>[n(h,{size:"24",class:"me-3",icon:"tabler:world-cancel"})]),default:r(()=>[n(F,null,{default:r(()=>[B("\uACB0\uC81C\uCDE8\uC18C\uD558\uAE30")]),_:1})]),_:1},512),[[E,a.item.is_cancel==!1]])]),_:1})]),_:1})]),_:1}))}}),Dt=["colspan"],At={key:3},xt=["onClick"],Et={key:1},bt={key:2},St={key:3},yt={key:4},Vt={key:5},Ft={key:6},wt={key:7},Lt={key:8},kt={key:9},$t={key:10},Tt={key:11},zt={key:12},Ue=O({__name:"index",setup(N){const{store:a,head:d,exporter:b}=lt(),{pgs:S,pss:L,settle_types:k,terminals:$,cus_filters:T}=it(),z=Bt(),_=H(),i=H();A("store",a),A("head",d),A("exporter",b),A("salesslip",_),A("cancelTran",i),a.params.level=10,a.params.dev_use=at.pv_options.auth.levels.dev_use;const c=H([{icon:"ic-outline-payments",color:"primary",title:"\uC2B9\uC778\uC561 \uD569\uACC4",stats:"0",percentage:0,subtitle:"0\uAC74"},{icon:"ic-outline-payments",color:"error",title:"\uCDE8\uC18C\uC561 \uD569\uACC4",stats:"0",percentage:0,subtitle:"0\uAC74"},{icon:"ic-outline-payments",color:"success",title:"\uB9E4\uCD9C\uC561 \uD569\uACC4",stats:"0",percentage:0,subtitle:"0\uAC74"},{icon:"ic-outline-payments",color:"warning",title:"\uC815\uC0B0\uC561 \uD569\uACC4",stats:"0",percentage:0,subtitle:"0\uAC74"}]),Q=p=>{const g=["amount","trx_amount","mcht_settle_fee","hold_amount","total_trx_amount","profit"];for(let t=0;t<g.length;t++)if(g[t]===p)return!0;return!1};return st(()=>{ot(async()=>{if(a.params.page==1){const p=await a.getChartData();c.value[0].stats=p.data.appr.amount.toLocaleString()+" \uFFE6",c.value[1].stats=p.data.cxl.amount.toLocaleString()+" \uFFE6",c.value[2].stats=p.data.amount.toLocaleString()+" \uFFE6",c.value[3].stats=p.data.profit.toLocaleString()+" \uFFE6",c.value[0].subtitle=p.data.appr.count.toLocaleString()+"\uAC74",c.value[1].subtitle=p.data.cxl.count.toLocaleString()+"\uAC74",c.value[2].subtitle=p.data.count.toLocaleString()+"\uAC74",c.value[3].subtitle=p.data.count.toLocaleString()+"\uAC74",c.value[0].percentage=p.data.appr.amount?100:0,c.value[1].percentage=a.getPercentage(p.data.cxl.amount,p.data.appr.amount),c.value[2].percentage=a.getPercentage(p.data.amount,p.data.appr.amount),c.value[3].percentage=a.getPercentage(p.data.profit,p.data.appr.amount)}})}),(p,g)=>(e(),o("div",null,[n(Ct,{placeholder:"MID, TID, \uC2B9\uC778\uBC88\uD638, \uAC70\uB798\uBC88\uD638 \uAC80\uC0C9",metas:u(c),add:u(nt).level>=35,add_name:"\uB9E4\uCD9C",is_range_date:!0},{filter:r(()=>[n(ft,{pg:!0,ps:!0,pay_cond:!0,terminal:!0,cus_filter:!0,sales:!0},{extra_left:r(()=>[n(gt,{cols:"12",sm:"3"},{default:r(()=>[n(vt,{"menu-props":{maxHeight:400},modelValue:u(a).params.level,"onUpdate:modelValue":g[0]||(g[0]=t=>u(a).params.level=t),items:u(z),label:"\uB4F1\uAE09 \uC120\uD0DD","item-title":"title","item-value":"id",create:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),headers:r(()=>[y("tr",null,[(e(!0),o(f,null,D(u(d).getColspansComputed,(t,C)=>(e(),o("th",{colspan:t,key:C,class:"list-square"},[y("span",null,m(u(d).main_headers[C]),1)],8,Dt))),128))]),y("tr",null,[(e(!0),o(f,null,D(u(d).flat_headers,(t,C)=>x((e(),o("th",{key:C,class:"list-square"},[C=="total_trx_amount"?(e(),w(M,{key:0,location:"top",text:t.ko,content:"\uCD1D \uAC70\uB798 \uC218\uC218\uB8CC = \uAE08\uC561 - (\uAC70\uB798 \uC218\uC218\uB8CC + \uC720\uBCF4\uAE08 + \uC785\uAE08 \uC218\uC218\uB8CC)"},null,8,["text","content"])):C=="mcht_settle_fee"?(e(),w(M,{key:1,location:"top",text:t.ko,content:"\uC785\uAE08 \uC218\uC218\uB8CC\uB294 \uAC00\uB9F9\uC810\uB9CC \uC801\uC6A9\uB429\uB2C8\uB2E4."},null,8,["text","content"])):C=="hold_amount"?(e(),w(M,{key:2,location:"top",text:t.ko,content:"\uC720\uBCF4\uAE08\uC740 \uAC00\uB9F9\uC810\uB9CC \uC801\uC6A9\uB429\uB2C8\uB2E4."},null,8,["text","content"])):(e(),o("span",At,m(t.ko),1))])),[[E,t.visible]])),128))])]),body:r(()=>[(e(!0),o(f,null,D(u(a).items,(t,C)=>(e(),o("tr",{key:C,style:{height:"3.75rem"}},[(e(!0),o(f,null,D(u(d).headers,(I,s,W)=>{var P,G,R,U,j,J,K;return e(),o(f,{key:W},[u(d).getDepth(I,0)!=1?(e(!0),o(f,{key:0},D(I,(l,q,Y)=>x((e(),o("td",{key:Y,class:"list-square"},[y("span",null,m(t[s][q]),1)])),[[E,l.visible]])),128)):x((e(),o("td",{key:1,style:ut(t.is_cancel?"color:red;":""),class:"list-square"},[s=="id"?(e(),o("span",{key:0,class:"edit-link",onClick:l=>u(a).edit(t.id)}," #"+m(t[s]),9,xt)):s=="module_type"?(e(),o("span",Et,[n(Z,{color:u(a).getSelectIdColor((P=u(X).find(l=>l.id===t[s]))==null?void 0:P.id)},{default:r(()=>{var l;return[B(m((l=u(X).find(q=>q.id===t[s]))==null?void 0:l.title),1)]}),_:2},1032,["color"])])):s=="installment"?(e(),o("span",bt,m((G=u(rt).find(l=>l.id===t[s]))==null?void 0:G.title),1)):s=="pg_id"?(e(),o("span",St,m((R=u(S).find(l=>l.id===t[s]))==null?void 0:R.pg_name),1)):s=="ps_id"?(e(),o("span",yt,m((U=u(L).find(l=>l.id===t[s]))==null?void 0:U.name),1)):s=="settle_type"?(e(),o("span",Vt,m((j=u(k).find(l=>l.id===t[s]))==null?void 0:j.name),1)):s=="terminal_id"?(e(),o("span",Ft,m((J=u($).find(l=>l.id===t[s]))==null?void 0:J.name),1)):Q(s)?(e(),o("span",wt,m(Number(t[s]).toLocaleString()),1)):s.toString().includes("_fee")&&s!="mcht_settle_fee"?(e(),o("span",Lt,[n(Z,null,{default:r(()=>[B(m((t[s]*100).toFixed(3))+" % ",1)]),_:2},1024)])):s=="pay_cond_price"?(e(),o("span",kt,m(t.settle_fee),1)):s=="custom_id"?(e(),o("span",$t,m((K=u(T).find(l=>l.id===t[s]))==null?void 0:K.name),1)):s=="extra_col"?(e(),o("span",Tt,[n(ht,{item:t},null,8,["item"])])):(e(),o("span",zt,m(t[s]),1))],4)),[[E,I.visible]])],64)}),128))]))),128))]),_:1},8,["metas","add"]),n(dt,{ref_key:"salesslip",ref:_,pgs:u(S)},null,8,["pgs"]),n(_t,{ref_key:"cancelTran",ref:i},null,512)]))}});export{Ue as default};
