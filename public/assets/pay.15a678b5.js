import{a4 as N,a as l,a2 as U,bl as x,ae as w}from"./main.78b17f62.js";import{c as q}from"./index.f0929df4.js";const S=e=>{const i=N(),o=l(0),_=l(0),m=l(!1),a=l(0),d=l({}),c=l([]),p=l(""),y=l(""),v=new URL(window.location.href).origin+"/pay/result",g=r=>["paytus","koneps","aynil","welcome","hecto","lumen","payletter","wholebic","korpay","kppay","thepayone","ezpg","cmpay","kiwoom"][r-1],h=async()=>{const r=new URLSearchParams(window.location.search),t=decodeURIComponent(r.get("e")||""),f=q.exports.AES.decrypt(t,"^^_masking_^^").toString(q.exports.enc.Utf8),s=JSON.parse(f);s.m!=null&&s.p!=null&&s.m!=0&&s.p!=0?(_.value=s.p,m.value=s.o,a.value=s.i,o.value=s.g,w.get("/api/v1/merchandises/"+s.m+"/sale-slip").then(u=>{Object.assign(d.value,u.data)}).catch(u=>{i.replace("/404")}),w.get("/api/v1/pay-gateways/"+s.g+"/sale-slip").then(u=>{Object.assign(c.value,u.data)}).catch(u=>{i.replace("/404")})):i.replace("/404")};return U(()=>{if(c.value.length>0&&o.value){const r=c.value.find(t=>t.id===o.value);if(r){p.value=g(r.pg_type||1);let t="";e==2?t="auth":e==3&&(t="simple"),y.value="http://localhost:81/v2/pay/"+t+"/"+p.value}}}),{pg_id:o,pmod_id:_,is_old_auth:m,pg_type:p,installment:a,merchandise:d,return_url:v,pgs:c,pgTypeToPath:g,getSalesSlipInfo:h,pay_url:y}},L=()=>{var p,y,v,g,h,r,t,f,s,u;const e=x(),i=e.query.result_cd,o=e.query.result_msg,_=e.query.pmod_id,m=e.query.pg_id,a=l({}),d=l([]),c=async(b,R)=>{try{const[n,k]=await Promise.all([w.get("/api/v1/manager/pay-modules/"+b+"/sales-slip"),w.get("/api/v1/pay-gateways/"+R+"/sale-slip")]);a.value.mcht={id:0,addr:n.data.addr,business_num:n.data.business_num,resident_num:n.data.resident_num,mcht_name:n.data.mcht_name,nick_name:n.data.nick_name,is_show_fee:n.data.is_show_fee,use_saleslip_prov:n.data.use_saleslip_prov,use_saleslip_sell:n.data.use_saleslip_sell,user_name:""},d.value=k.data}catch(n){throw console.log(n),n}};return(async()=>_&&m&&await c(Number(_),Number(m)))(),a.value.acquirer=(p=e.query.acquirer)!=null?p:"",a.value.issuer=(y=e.query.issuer)!=null?y:"",a.value.amount=(v=e.query.amount)!=null?v:0,a.value.buyer_name=(g=e.query.buyer_name)!=null?g:"",a.value.card_num=(h=e.query.card_num)!=null?h:"",a.value.item_name=(r=e.query.item_nm)!=null?r:"",a.value.appr_num=(t=e.query.appr_num)!=null?t:"",a.value.installment=(f=e.query.instment)!=null?f:0,a.value.trx_dttm=(s=e.query.trx_dttm)!=null?s:new Date,a.value.is_cancel=Boolean((u=e.query.is_cancel)!=null?u:!1),{sale_slip:a,pgs:d,result_cd:i,result_msg:o}};export{L as a,S as p};
